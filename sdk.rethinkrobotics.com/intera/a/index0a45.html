<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">

<!-- Mirrored from sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&oldid=1165 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Oct 2019 05:22:45 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8"/>
<title>Joint Position Example - Intera SDK</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Joint_Position_Example","wgTitle":"Joint Position Example","wgCurRevisionId":1165,"wgRevisionId":1165,"wgArticleId":57,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Joint_Position_Example","wgRelevantArticleId":57,"wgRequestId":"dbb12009411e338eecddfcf3","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","site":"ready","user.options":"ready","user.tokens":"loading","ext.pygments":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.cavendishrr":"ready"});mw.loader.implement("user.tokens@09sx7ae",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","cavendishrr.html","app.js"]);});</script>
<link rel="stylesheet" href="load8c61.css?debug=false&amp;lang=en&amp;modules=ext.pygments%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cskins.cavendishrr&amp;only=styles&amp;skin=cavendishrr"/>
<script async="" src="loada191.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=cavendishrr"></script>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,300italic,400,500,500italic,700|Roboto+Condensed:300,700|Open+Sans:300"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load8ac3.css?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=cavendishrr"/>
<meta name="generator" content="MediaWiki 1.31.0"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="shortcut icon" href="http://sdk.rethinkrobotics.com/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://sdk.rethinkrobotics.com/intera/a/opensearch_desc.php" title="Intera SDK (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="http://sdk.rethinkrobotics.com/intera/a/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="Intera SDK Atom feed" href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/intera/a/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=CavendishRR&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Joint_Position_Example rootpage-Joint_Position_Example skin-cavendishrr action-view"><div id="container"><!-- start fragment header -->
    <div id="header" class="noprint">
            <a name="top" id="contentTop"></a>

            <!-- Logo + site name -->
            <h1>
                <a href="http://sdk.rethinkrobotics.com/intera/Main_Page" style="text-indent: 2em; width: 123px; height: 69px; background: transparent url(http://sdk.rethinkrobotics.com/intera/a/skins/CavendishRR/styles/images/header_logo.png) no-repeat scroll;" title="Visit the main page">&nbsp;</a>            </h1>

            <div id="rr_ActionWrap">
                <!-- Account action links -->
                <div id="accountActions"><a href="http://sdk-accounts.rethinkrobotics.com/public/NewUser">Create account</a><a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Special:UserLogin&amp;returnto=Joint+Position+Example&amp;returntoquery=oldid%3D1165">Log in</a></div>                <!-- Search box -->
                        <form action="http://sdk.rethinkrobotics.com/intera/a/index.php" id="searchform">
            <label for="searchInput">Search</label>
            <input type='hidden' name="title" value="Special:Search"/>
            <input type="search" name="search" placeholder="Search Intera SDK" title="Search Intera SDK [f]" accesskey="f" id="searchInput"/>
                            <button type="submit" name="button">Search</button>        </form>
                </div><!--/#rr_ActionWrap-->
    </div> <!-- End header div -->
<!-- end fragment header --><div id="mBody"><!-- start fragment mainContent -->
<!-- start fragment firstHeader -->
<div id="firstHeadingDiv" class="firstHeading">
    <div class="l-container">
        <!-- Content action buttons -->
                <ul class="m-cactions">
            <li><a href="#">More</a>
                <ul>
                <li id="ca-viewsource"><a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>                </ul>
            </li>

            <li id="ca-nstab-main" class="selected"><a href="http://sdk.rethinkrobotics.com/intera/Joint_Position_Example" title="View the content page [c]" accesskey="c">Page</a></li>        </ul>
        
        <h1 lang="en">
            <span dir="auto">Joint Position Example</span>
        </h1>
    </div><!--/.l-container-->
</div><!--/#firstHeadingDiv-->
<!-- end fragment firstHeader -->
<div class="bg-wrapper clearfix">
    <!-- start fragment sidebar -->
    <div id="side" class="noprint" > <!-- cavendishmw: s/column-one/side/ -->
        <ul id="nav">
                  <li>
          <span>Installation &amp; Configuration</span>

                    <ul class="collapsible-collapsed">
                                    <li id="n-Robot-Setup"><a href="http://sdk.rethinkrobotics.com/intera/Robot_Setup">Robot Setup</a></li>                                    <li id="n-Workstation-Setup"><a href="http://sdk.rethinkrobotics.com/intera/Workstation_Setup">Workstation Setup</a></li>                                    <li id="n-Networking"><a href="http://sdk.rethinkrobotics.com/intera/Networking">Networking</a></li>                                    <li id="n-Hello-Robot.21"><a href="http://sdk.rethinkrobotics.com/intera/Hello_Robot">Hello Robot!</a></li>                                    <li id="n-Hardware-Components"><a href="http://sdk.rethinkrobotics.com/intera/Hardware_Components">Hardware Components</a></li>                                    <li id="n-SDK-Workstation-Requirements"><a href="http://sdk.rethinkrobotics.com/intera/System_requirements">SDK Workstation Requirements</a></li>                                    <li id="n-Robot-Workspace-Guidelines"><a href="http://sdk.rethinkrobotics.com/intera/Workspace_Guidelines">Robot Workspace Guidelines</a></li>                                    <li id="n-Field-Service-Menu-.28FSM.29"><a href="http://sdk.rethinkrobotics.com/intera/Field_Service_Menu_(FSM)">Field Service Menu (FSM)</a></li>                                    <li id="n-Time-and-NTP"><a href="http://sdk.rethinkrobotics.com/intera/Time_and_NTP">Time and NTP</a></li>                                    <li id="n-SDK-Software-Update"><a href="http://sdk.rethinkrobotics.com/intera/Software_Update">SDK Software Update</a></li>                                    <li id="n-SDK-Release-Notes"><a href="http://sdk.rethinkrobotics.com/intera/Release-Changes">SDK Release Notes</a></li>                            </ul>
                </li>
          <li>
          <span>Concepts</span>

                    <ul class="collapsible-collapsed">
                                    <li id="n-SDK-Robot-Workstation-Overview"><a href="http://sdk.rethinkrobotics.com/intera/SDK_System_Overview">SDK Robot-Workstation Overview</a></li>                                    <li id="n-E-STOP-and-Enable-Robot"><a href="http://sdk.rethinkrobotics.com/intera/E-STOP_and_Enable_Robot">E-STOP and Enable Robot</a></li>                                    <li id="n-Arm-Calibration"><a href="http://sdk.rethinkrobotics.com/intera/Arm_Calibration">Arm Calibration</a></li>                                    <li id="n-Arm-Control-Systems"><a href="http://sdk.rethinkrobotics.com/intera/Arm_Control_Systems">Arm Control Systems</a></li>                                    <li id="n-API-Reference"><a href="http://sdk.rethinkrobotics.com/intera/API_Reference">API Reference</a></li>                            </ul>
                </li>
          <li>
          <span>Tutorials</span>

                    <ul class="collapsible-collapsed">
                                    <li id="n-Interaction-Control-Tutorial"><a href="http://sdk.rethinkrobotics.com/intera/Interaction_Control_Tutorial">Interaction Control Tutorial</a></li>                                    <li id="n-Motion-Interface-Tutorial"><a href="http://sdk.rethinkrobotics.com/intera/Motion_Interface_Tutorial">Motion Interface Tutorial</a></li>                                    <li id="n-MoveIt.21-Tutorial"><a href="http://sdk.rethinkrobotics.com/intera/MoveIt_Tutorial">MoveIt! Tutorial</a></li>                                    <li id="n-Gazebo-Tutorial"><a href="http://sdk.rethinkrobotics.com/intera/Gazebo_Tutorial">Gazebo Tutorial</a></li>                            </ul>
                </li>
          <li>
          <span>Code Examples</span>

                    <ul class="collapsible-collapsed">
                                    <li id="n-Running-Examples-Overview"><a href="http://sdk.rethinkrobotics.com/intera/Running_Examples_Overview">Running Examples Overview</a></li>                                    <li id="n-Camera-Image-Display-Example"><a href="http://sdk.rethinkrobotics.com/intera/Camera_Image_Display_Example">Camera Image Display Example</a></li>                                    <li id="n-Gripper-Example"><a href="http://sdk.rethinkrobotics.com/intera/Gripper_Example">Gripper Example</a></li>                                    <li id="n-Gripper-Cuff-Control-Example"><a href="http://sdk.rethinkrobotics.com/intera/Gripper_Cuff_Control_Example">Gripper Cuff Control Example</a></li>                                    <li id="n-Head-Display-Image-Example"><a href="http://sdk.rethinkrobotics.com/intera/Head_Display_Image_Example">Head Display Image Example</a></li>                                    <li id="n-Head-Movement-Example"><a href="http://sdk.rethinkrobotics.com/intera/Head_Movement_Example">Head Movement Example</a></li>                                    <li id="n-Lights-Blinking-Example"><a href="http://sdk.rethinkrobotics.com/intera/Lights_Blinking_Example">Lights Blinking Example</a></li>                                    <li id="n-IK-Service-Example"><a href="http://sdk.rethinkrobotics.com/intera/IK_Service_Example">IK Service Example</a></li>                                    <li id="n-Joint-Position-Example"><a href="http://sdk.rethinkrobotics.com/intera/Joint_Position_Example">Joint Position Example</a></li>                                    <li id="n-Joint-Position-Waypoint-Example"><a href="http://sdk.rethinkrobotics.com/intera/Joint_Position_Waypoint_Example">Joint Position Waypoint Example</a></li>                                    <li id="n-Joint-Torque-Springs-Example"><a href="http://sdk.rethinkrobotics.com/intera/Joint_Torque_Springs_Example">Joint Torque Springs Example</a></li>                                    <li id="n-Joint-Trajectory-Playback-Example"><a href="http://sdk.rethinkrobotics.com/intera/Joint_Trajectory_Playback_Example">Joint Trajectory Playback Example</a></li>                                    <li id="n-Set-Interaction-Options-Example"><a href="http://sdk.rethinkrobotics.com/intera/Set_Interaction_Options_Example">Set Interaction Options Example</a></li>                                    <li id="n-Motion-Interface-Go-To-Joint-Angles"><a href="http://sdk.rethinkrobotics.com/intera/Go_To_Joint_Angles_Example">Motion Interface Go-To-Joint Angles</a></li>                            </ul>
                </li>
          <li>
          <span>Support</span>

                    <ul class="collapsible-collapsed">
                                    <li id="n-User-Forum"><a href="http://sdk.rethinkrobotics.com/intera/User_Forum">User Forum</a></li>                            </ul>
                </li>
          <li>
          <span>Tools</span>

                    <ul class="collapsible-collapsed">
                                    <li id="n-All-Pages"><a href="http://sdk.rethinkrobotics.com/intera/Special:AllPages">All Pages</a></li>                                    <li id="n-Print"><a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;printable=yes" rel="nofollow">Print</a></li>                                    <li id="n-Upload-File"><a href="http://sdk.rethinkrobotics.com/intera/Special:Upload">Upload File</a></li>                                    <li id="n-What-Links-Here.3F"><a href="http://sdk.rethinkrobotics.com/intera/Special:WhatLinksHere">What Links Here?</a></li>                            </ul>
                </li>
            </ul> <!-- /nav -->
    </div> <!-- /side -->
<!-- end fragment sidebar -->
    <div id="mainContent"> <!-- cavendishmw: s/column-content/mainContent/ -->
        
        <div id="bodyContent" class="mw-body">

            <div id="contentSub">
                <div class="mw-revision"><div id="mw-revision-info">Revision as of 20:34, 16 January 2017 by <a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=User:Swang&amp;action=edit&amp;redlink=1" class="new mw-userlink" title="User:Swang (page does not exist)"><bdi>Swang</bdi></a> <span class="mw-usertoollinks">(<a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=User_talk:Swang&amp;action=edit&amp;redlink=1" class="new mw-usertoollinks-talk" title="User talk:Swang (page does not exist)">talk</a> | <a href="http://sdk.rethinkrobotics.com/intera/Special:Contributions/Swang" class="mw-usertoollinks-contribs" title="Special:Contributions/Swang">contribs</a>)</span></div><div id="mw-revision-nav">(<a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;diff=prev&amp;oldid=1165" title="Joint Position Example">diff</a>) <a href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;direction=prev&amp;oldid=1165" title="Joint Position Example">← Older revision</a> | Latest revision (diff) | Newer revision → (diff)</div></div>            </div>

            
            
                            <div id="jump-to-nav" class="mw-jump">
                    Jump to:                    <a href="#column-one">navigation</a>
                    ,                     <a href="#searchInput">search</a>
                </div>
            
            <!-- start content -->
            <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><div class="title-block">
<p><span style="font-size:120%;"><b>The joint position example(keyboard, joystick) demonstrates basic joint position control. The key or button mapped to either increasing or decreasing the angle of a particular joint on Sawyer's arm.</b></span>
</p>
</div>
<div class="toclimit-2"><div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Arguments"><span class="tocnumber">3</span> <span class="toctext">Arguments</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Joint_Position_Keyboard_Code_Walkthrough"><span class="tocnumber">4</span> <span class="toctext">Joint Position Keyboard Code Walkthrough</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Joint_Position_Joystick_Code_Walkthrough"><span class="tocnumber">5</span> <span class="toctext">Joint Position Joystick Code Walkthrough</span></a></li>
</ul>
</div>
</div>
<div class="content-block">
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>Use a game controller or your dev machine's keyboard  to control the angular joint positions of Sawyer's arm. 
If you would like to follow along with the actual source code for these examples on GitHub, it can be found through <a rel="nofollow" class="external text" href="https://github.com/RethinkRobotics/intera_sdk/blob/master/intera_examples/scripts/joint_position_joystick.py">link for joint position joystick</a> and <a rel="nofollow" class="external text" href="https://github.com/RethinkRobotics/intera_sdk/blob/master/intera_examples/scripts/joint_position_keyboard.py">link for joint position keyboard</a>.
</p>
</div>
<div class="content-block">
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>Start the joint position keyboard example program, ex:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>$ rosrun intera_examples joint_position_keyboard.py
</pre></div>
<p>Start the joint position joystick example program, ex:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>$ rosrun intera_examples joint_position_joystick.py
</pre></div>
<p>Upon startup, you will be prompted with the following:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>Initializing node... 
Getting robot state... 
Enabling robot... 
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span>WallTime: <span class="m">1399575163</span>.891211<span class="o">]</span> Robot Enabled
Controlling joints. Press ? <span class="k">for</span> help, Esc to quit.
</pre></div>
</div>
<div class="content-block">
<h2><span class="mw-headline" id="Arguments">Arguments</span></h2>
<p><b>Important Arguments:</b>  
</p><p>See the joint position example available arguments on the command line by passing:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>$ rosrun intera_examples joint_position_keyboard.py -h
</pre></div>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>usage: joint_position_keyboard.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-l LIMB<span class="o">]</span>

RSDK Joint Position Example: Keyboard Control
    Use your dev machine<span class="s1">&#39;s keyboard to control joint positions.</span>
<span class="s1">    Each key corresponds to increasing or decreasing the angle</span>
<span class="s1">    of a joint on Sawyer&#39;</span>s arm. The increasing and descreasing
    are represented by number key and letter key next to the number.
    

optional arguments:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -l LIMB, --limb LIMB
                        Limb on which to run the joint position keyboard example
</pre></div>
<p>For joint position joystick example: 
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>$ rosrun intera_examples joint_position_joystick.py -h
</pre></div>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>usage: joint_position_joystick.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-l LIMB<span class="o">]</span> <span class="o">[</span>-j JOYSTICK<span class="o">]</span>

SDK Joint Position Example: Joystick Control
    Use a game controller to control the angular joint positions
    of Sawyer<span class="s1">&#39;s arms.</span>
<span class="s1">    Attach a game controller to your dev machine and run this</span>
<span class="s1">    example along with the ROS joy_node to control the position</span>
<span class="s1">    of each joint in Sawyer&#39;</span>s arm using the joystick. Be sure to
    provide your *joystick* <span class="nb">type</span> to setup appropriate key mappings.
    Each stick axis maps to a joint angle<span class="p">;</span> which joints are currently
    controlled can be incremented by using the mapped increment buttons.
    Ex:
      <span class="o">(</span>x,y -&gt; e0,e1<span class="o">)</span> &gt;&gt;increment&gt;&gt; <span class="o">(</span>x,y -&gt; e1,e2<span class="o">)</span>

required arguments:
  -j, --joystick        specify the <span class="nb">type</span> of joystick to use

optional arguments:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -l LIMB, --limb LIMB
                        Limb on which to run the joint position joystick example
</pre></div>
<p><br />
</p>
</div>
<div class="content-block">
<h2><span class="mw-headline" id="Joint_Position_Keyboard_Code_Walkthrough">Joint Position Keyboard Code Walkthrough</span></h2>
<p>Now, let's break down the code.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">33 </span><span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">34 </span><span class="sd">SDK Joint Position Example: keyboard</span>
<span class="lineno">35 </span><span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">36 </span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="lineno">37 </span>
<span class="lineno">38 </span><span class="kn">import</span> <span class="nn">rospy</span>
<span class="lineno">39 </span>
<span class="lineno">40 </span><span class="kn">import</span> <span class="nn">intera_interface</span>
<span class="lineno">41 </span><span class="kn">import</span> <span class="nn">intera_external_devices</span>
<span class="lineno">42 </span>
<span class="lineno">43 </span><span class="kn">from</span> <span class="nn">intera_interface</span> <span class="kn">import</span> <span class="n">CHECK_VERSION</span>
</pre></div>
<p>This imports the intera interface for accessing the limb and the gripper class. The <code>intera_external_devices</code> is imported to use its getch function, that captures the key presses on the keyboard. The <code>CHECK_VERSION</code> is imported to check if the software running on the robot would be compatible with this local version. It is not necessary to check the version in custom programs.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">43 </span><span class="k">def</span> <span class="nf">map_keyboard</span><span class="p">(</span><span class="n">side</span><span class="p">):</span>
<span class="lineno">44 </span>    <span class="n">limb</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">Limb</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
<span class="lineno">45 </span>    
<span class="lineno">46 </span>    <span class="k">try</span><span class="p">:</span>
<span class="lineno">47 </span>        <span class="n">gripper</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">Gripper</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
<span class="lineno">48 </span>    <span class="k">except</span><span class="p">:</span>
<span class="lineno">49 </span>        <span class="n">has_gripper</span> <span class="o">=</span> <span class="bp">False</span>
<span class="lineno">50 </span>        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s2">&quot;Could not initalize the gripper.&quot;</span><span class="p">)</span>
<span class="lineno">51 </span>    <span class="k">else</span><span class="p">:</span>
<span class="lineno">52 </span>        <span class="n">has_gripper</span> <span class="o">=</span> <span class="bp">True</span>
<span class="lineno">53 </span>
<span class="lineno">54 </span>    <span class="n">joints</span> <span class="o">=</span> <span class="n">limb</span><span class="o">.</span><span class="n">joint_names</span><span class="p">()</span>
</pre></div>
<p>The instance of Limb class, <code>limb</code> and the instance of Gripper class, <code>gripper</code> are created. <code>joint_names()</code> method returns an array of joints of the limb.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">56 </span>    <span class="k">def</span> <span class="nf">set_j</span><span class="p">(</span><span class="n">limb</span><span class="p">,</span> <span class="n">joint_name</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
<span class="lineno">57 </span>        <span class="n">current_position</span> <span class="o">=</span> <span class="n">limb</span><span class="o">.</span><span class="n">joint_angle</span><span class="p">(</span><span class="n">joint_name</span><span class="p">)</span>
<span class="lineno">58 </span>        <span class="n">joint_command</span> <span class="o">=</span> <span class="p">{</span><span class="n">joint_name</span><span class="p">:</span> <span class="n">current_position</span> <span class="o">+</span> <span class="n">delta</span><span class="p">}</span>
<span class="lineno">59 </span>        <span class="n">limb</span><span class="o">.</span><span class="n">set_joint_positions</span><span class="p">(</span><span class="n">joint_command</span><span class="p">)</span>
<span class="lineno">60 </span>
<span class="lineno">61 </span>    <span class="k">def</span> <span class="nf">set_g</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
<span class="lineno">62 </span>        <span class="k">if</span> <span class="n">has_gripper</span><span class="p">:</span>
<span class="lineno">63 </span>            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;close&quot;</span><span class="p">:</span>
<span class="lineno">64 </span>                <span class="n">gripper</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="lineno">65 </span>            <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;open&quot;</span><span class="p">:</span>
<span class="lineno">66 </span>                <span class="n">gripper</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="lineno">67 </span>            <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;calibrate&quot;</span><span class="p">:</span>
<span class="lineno">68 </span>                <span class="n">gripper</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
</pre></div>
<p>The <code>set_j()</code> function is invoked whenever a valid key press occurs. The <code>limb</code> refers to the limb instance of Sawyer's limb. <code>delta</code> refers to the required displacement of the joint from its current position. The method <code>joint_angle()</code> returns the current position of that joint. Then the joint command message is updated for that corresponding joint to indicate the new position. <code>set_joint_position()</code> method publishes the joint commands to the position controller. 
The <code>set_g</code> function calls gripper action function(<code>open()</code>, or <code>close()</code> or <code>calibrate()</code>) when corresponding action is provided.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">70 </span>    <span class="n">bindings</span> <span class="o">=</span> <span class="p">{</span>
<span class="lineno">71 </span>        <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">72 </span>        <span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">73 </span>        <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">74 </span>        <span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">75 </span>        <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">76 </span>        <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">77 </span>        <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">78 </span>        <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">79 </span>        <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">80 </span>        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">81 </span>        <span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">82 </span>        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">83 </span>        <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; increase&quot;</span><span class="p">),</span>
<span class="lineno">84 </span>        <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">joints</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; decrease&quot;</span><span class="p">),</span>
<span class="lineno">85 </span>        <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_g</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">,</span> <span class="n">side</span><span class="o">+</span><span class="s2">&quot; gripper close&quot;</span><span class="p">),</span>
<span class="lineno">86 </span>        <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_g</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">side</span><span class="o">+</span><span class="s2">&quot; gripper open&quot;</span><span class="p">),</span>
<span class="lineno">87 </span>        <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">set_g</span><span class="p">,</span> <span class="s2">&quot;calibrate&quot;</span><span class="p">,</span> <span class="n">side</span><span class="o">+</span><span class="s2">&quot; gripper calibrate&quot;</span><span class="p">)</span>
<span class="lineno">88 </span>     <span class="p">}</span>
</pre></div>
<p>The <code>bindings</code> is a dictionary that holds the set of characters in the keyboard and their corresponding joints.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">89 </span>    <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
<span class="lineno">90 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Controlling joints. Press ? for help, Esc to quit.&quot;</span><span class="p">)</span>
<span class="lineno">91 </span>    <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">rospy</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">():</span>
<span class="lineno">92 </span>        <span class="n">c</span> <span class="o">=</span> <span class="n">intera_external_devices</span><span class="o">.</span><span class="n">getch</span><span class="p">()</span>
<span class="lineno">93 </span>        <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
<span class="lineno">94 </span>            <span class="c1">#catch Esc or ctrl-c</span>
<span class="lineno">95 </span>            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\x1b</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\x03</span><span class="s1">&#39;</span><span class="p">]:</span>
<span class="lineno">96 </span>                <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
<span class="lineno">97 </span>                <span class="n">rospy</span><span class="o">.</span><span class="n">signal_shutdown</span><span class="p">(</span><span class="s2">&quot;Example finished.&quot;</span><span class="p">)</span>
</pre></div>
<p>The <code>done</code> variable captures whether "esc" or "ctrl-c" was hit. The while loop iterates as long as the "esc" or "ctrl-c" is hit or ros-shutdown signal is given. c captures the keyboard input. If "esc" or "ctrl-c" is given then <code>done</code> gets updated as true, and a shutdown signal will be sent.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno"> 98 </span>            <span class="k">elif</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">bindings</span><span class="p">:</span>
<span class="lineno"> 99 </span>                <span class="n">cmd</span> <span class="o">=</span> <span class="n">bindings</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
<span class="lineno">100 </span>                <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;8&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;9&#39;</span><span class="p">:</span>
<span class="lineno">101 </span>                    <span class="n">cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="lineno">102 </span>                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;command: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd</span><span class="p">[</span><span class="mi">2</span><span class="p">],))</span>
<span class="lineno">103 </span>                <span class="k">else</span><span class="p">:</span>
<span class="lineno">104 </span>                    <span class="c1">#expand binding to something like &quot;set_j(right, &#39;j0&#39;, 0.1)&quot;</span>
<span class="lineno">105 </span>                    <span class="n">cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="lineno">106 </span>                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;command: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cmd</span><span class="p">[</span><span class="mi">2</span><span class="p">],))</span>
</pre></div>
<p>The user inputted key is checked whether it is in the <code>bindings</code> dictionary. <code>bindings[c]</code> returns the value of the key c from the dictionary. The 0th index of the value refers to the function to be called and the next index holds the arguments to be sent along with that function. <code>cmd[2]</code> is the description of the joint command from the dictionary above.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">107 </span>            <span class="k">else</span><span class="p">:</span>
<span class="lineno">108 </span>                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;key bindings: &quot;</span><span class="p">)</span>
<span class="lineno">109 </span>                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;  Esc: Quit&quot;</span><span class="p">)</span>
<span class="lineno">110 </span>                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;  ?: Help&quot;</span><span class="p">)</span>
<span class="lineno">111 </span>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">bindings</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
<span class="lineno">112 </span>                                       <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]):</span>
<span class="lineno">113 </span>                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;  </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
<p>This case is executed when the key pressed is not a valid input. So, the key is sorted and is printed along with its corresponding description.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">115 </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="lineno">116 </span>    <span class="sd">&quot;&quot;&quot;RSDK Joint Position Example: Keyboard Control</span>
<span class="lineno">117 </span><span class="sd">    Use your dev machine&#39;s keyboard to control joint positions.</span>
<span class="lineno">118 </span><span class="sd">    Each key corresponds to increasing or decreasing the angle</span>
<span class="lineno">119 </span><span class="sd">    of a joint on Sawyer&#39;s arm. The increasing and descreasing</span>
<span class="lineno">120 </span><span class="sd">    are represented by number key and letter key next to the number.</span>
<span class="lineno">121 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">122 </span>    <span class="n">epilog</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="lineno">123 </span><span class="s2">See help inside the example with the &#39;?&#39; key for key bindings.</span>
<span class="lineno">124 </span><span class="s2">    &quot;&quot;&quot;</span>
<span class="lineno">125 </span>    <span class="n">rp</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">RobotParams</span><span class="p">()</span>
<span class="lineno">126 </span>    <span class="n">valid_limbs</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">get_limb_names</span><span class="p">()</span>
<span class="lineno">127 </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_limbs</span><span class="p">:</span>
<span class="lineno">128 </span>        <span class="n">rp</span><span class="o">.</span><span class="n">log_message</span><span class="p">((</span><span class="s2">&quot;Cannot detect any limb parameters on this robot. &quot;</span>
<span class="lineno">129 </span>                        <span class="s2">&quot;Exiting.&quot;</span><span class="p">),</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">)</span>
<span class="lineno">130 </span>        <span class="k">return</span>
<span class="lineno">131 </span>    <span class="n">arg_fmt</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">RawDescriptionHelpFormatter</span>
<span class="lineno">132 </span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">formatter_class</span><span class="o">=</span><span class="n">arg_fmt</span><span class="p">,</span>
<span class="lineno">133 </span>                                     <span class="n">description</span><span class="o">=</span><span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
<span class="lineno">134 </span>                                     <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span>
<span class="lineno">135 </span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="lineno">136 </span>        <span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--limb&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;limb&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">valid_limbs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="lineno">137 </span>        <span class="n">choices</span><span class="o">=</span><span class="n">valid_limbs</span><span class="p">,</span>
<span class="lineno">138 </span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Limb on which to run the joint position keyboard example&quot;</span>
<span class="lineno">139 </span>    <span class="p">)</span>
<span class="lineno">140 </span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">rospy</span><span class="o">.</span><span class="n">myargv</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span>
<span class="lineno">141 </span>
<span class="lineno">142 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Initializing node... &quot;</span><span class="p">)</span>
<span class="lineno">143 </span>    <span class="n">rospy</span><span class="o">.</span><span class="n">init_node</span><span class="p">(</span><span class="s2">&quot;sdk_joint_position_keyboard&quot;</span><span class="p">)</span>
<span class="lineno">144 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Getting robot state... &quot;</span><span class="p">)</span>
<span class="lineno">145 </span>    <span class="n">rs</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">RobotEnable</span><span class="p">(</span><span class="n">CHECK_VERSION</span><span class="p">)</span>
<span class="lineno">146 </span>    <span class="n">init_state</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">enabled</span>
</pre></div>
<p>The node is initialized and then the software version is checked for compatiblity with the local version. <code>init_state</code> captures Sawyer's initial state. This is to make sure that Sawyer is sent back to the same state after the program exits.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">150 </span>    <span class="k">def</span> <span class="nf">clean_shutdown</span><span class="p">():</span>
<span class="lineno">151 </span>        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exiting example.&quot;</span><span class="p">)</span>
<span class="lineno">152 </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">init_state</span><span class="p">:</span>
<span class="lineno">153 </span>            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Disabling robot...&quot;</span><span class="p">)</span>
<span class="lineno">154 </span>            <span class="n">rs</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="lineno">155 </span>    <span class="n">rospy</span><span class="o">.</span><span class="n">on_shutdown</span><span class="p">(</span><span class="n">clean_shutdown</span><span class="p">)</span>
</pre></div>
<p>As explained above, the robot is checked if it was initially disabled and if so, it is disabled upon the program's termination.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">157 </span>    <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;Enabling robot...&quot;</span><span class="p">)</span>
<span class="lineno">158 </span>    <span class="n">rs</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="lineno">159 </span>    <span class="n">map_keyboard</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">limb</span><span class="p">)</span>
<span class="lineno">160 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
<span class="lineno">161 </span>
<span class="lineno">162 </span>
<span class="lineno">163 </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="lineno">164 </span>    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>The robot is enabled before the programs execution. It is important to note that Sawyer should be auto-enabled before trying to move its joints. <code>map_keyboard()</code> function captures the key input and moves the joint as explained above.
</p>
</div>
<div class="content-block">
<h2><span class="mw-headline" id="Joint_Position_Joystick_Code_Walkthrough">Joint Position Joystick Code Walkthrough</span></h2>
<p>Now, let's break down the code.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">33 </span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="lineno">34 </span>
<span class="lineno">35 </span><span class="kn">import</span> <span class="nn">rospy</span>
<span class="lineno">36 </span>
<span class="lineno">37 </span><span class="kn">import</span> <span class="nn">intera_interface</span>
<span class="lineno">38 </span><span class="kn">import</span> <span class="nn">intera_external_devices</span>
<span class="lineno">39 </span>
<span class="lineno">40 </span><span class="kn">from</span> <span class="nn">intera_interface</span> <span class="kn">import</span> <span class="n">CHECK_VERSION</span>
</pre></div>
<p>This imports the intera interface for accessing the limb and the gripper class. The <code>intera_external_devices</code> is imported to use its <code>joystick</code> function, that captures the key presses on the joystick. The <code>CHECK_VERSION</code> is imported to check if the software running on the robot would be compatible with this local version. It is not necessary to check the version in custom programs.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">43 </span><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="lineno">44 </span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">45 </span><span class="sd">    Rotates a list left.</span>
<span class="lineno">46 </span><span class="sd">    @param l: the list</span>
<span class="lineno">47 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">48 </span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
<span class="lineno">49 </span>        <span class="n">v</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="lineno">50 </span>        <span class="n">l</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="lineno">51 </span>        <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</pre></div>
<p>The <code>rotate</code> function rotates a list, it will be used in bindings. This moves all the elements in the list to one position to their left. So the element at 0th position moves to the nth position, element at nth position moves to (n-1)th position, and so on.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">54 </span><span class="k">def</span> <span class="nf">set_j</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
<span class="lineno">55 </span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">56 </span><span class="sd">    Set the selected joint to current pos + delta.</span>
<span class="lineno">57 </span><span class="sd">    @param cmd: the joint command dictionary</span>
<span class="lineno">58 </span><span class="sd">    @param limb: the limb to get the pos from</span>
<span class="lineno">59 </span><span class="sd">    @param joints: a list of joint names</span>
<span class="lineno">60 </span><span class="sd">    @param index: the index in the list of names</span>
<span class="lineno">61 </span><span class="sd">    @param delta: delta to update the joint by</span>
<span class="lineno">62 </span><span class="sd">    joint/index is to make this work in the bindings.</span>
<span class="lineno">63 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">64 </span>    <span class="n">joint</span> <span class="o">=</span> <span class="n">joints</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<span class="lineno">65 </span>    <span class="n">cmd</span><span class="p">[</span><span class="n">joint</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">+</span> <span class="n">limb</span><span class="o">.</span><span class="n">joint_angle</span><span class="p">(</span><span class="n">joint</span><span class="p">)</span>
</pre></div>
<p><code>joint_angle()</code> method returns the current angle of the corresponding joint. This function builds the dictionary that is to be passed as a joint command. The last line assigns the new position which has an offset of <code>delta</code> from the current position.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">69 </span><span class="k">def</span> <span class="nf">map_joystick</span><span class="p">(</span><span class="n">joystick</span><span class="p">,</span> <span class="n">side</span><span class="p">):</span>
<span class="lineno">70 </span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">71 </span><span class="sd">    Maps joystick input to joint position commands.</span>
<span class="lineno">72 </span><span class="sd">    @param joystick: an instance of a Joystick</span>
<span class="lineno">73 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">74 </span>    <span class="n">limb</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">Limb</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
<span class="lineno">75 </span>    <span class="n">gripper</span> <span class="o">=</span> <span class="bp">None</span>
<span class="lineno">76 </span>    <span class="k">try</span><span class="p">:</span>
<span class="lineno">77 </span>        <span class="n">gripper</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">Gripper</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>
<span class="lineno">78 </span>    <span class="k">except</span><span class="p">:</span>
<span class="lineno">79 </span>        <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;Could not detect a connected electric gripper.&quot;</span><span class="p">)</span>
</pre></div>
<p>The instance of Limb class and the instance of Gripper class are created. No gripper will raise could not detect gripper info.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">82 </span>    <span class="k">def</span> <span class="nf">set_g</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
<span class="lineno">83 </span>        <span class="k">if</span> <span class="n">gripper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<span class="lineno">84 </span>            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;close&quot;</span><span class="p">:</span>
<span class="lineno">85 </span>                <span class="n">gripper</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="lineno">86 </span>            <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;open&quot;</span><span class="p">:</span>
<span class="lineno">87 </span>                <span class="n">gripper</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="lineno">88 </span>            <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;calibrate&quot;</span><span class="p">:</span>
<span class="lineno">89 </span>                <span class="n">gripper</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
</pre></div>
<p>The <code>set_g</code> function calls gripper action function(<code>open()</code>, or <code>close()</code> or <code>calibrate()</code>) when corresponding action is provided.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno"> 91 </span>    <span class="n">limb_cmd</span> <span class="o">=</span> <span class="p">{}</span>
<span class="lineno"> 92 </span>
<span class="lineno"> 93 </span>    <span class="c1">#available joints</span>
<span class="lineno"> 94 </span>    <span class="n">joints</span> <span class="o">=</span> <span class="n">limb</span><span class="o">.</span><span class="n">joint_names</span><span class="p">()</span>
<span class="lineno"> 95 </span>
<span class="lineno"> 96 </span>    <span class="c1">#abbreviations</span>
<span class="lineno"> 97 </span>    <span class="n">jhi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">joystick</span><span class="o">.</span><span class="n">stick_value</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="lineno"> 98 </span>    <span class="n">jlo</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">joystick</span><span class="o">.</span><span class="n">stick_value</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="lineno"> 99 </span>    <span class="n">bdn</span> <span class="o">=</span> <span class="n">joystick</span><span class="o">.</span><span class="n">button_down</span>
<span class="lineno">100 </span>    <span class="n">bup</span> <span class="o">=</span> <span class="n">joystick</span><span class="o">.</span><span class="n">button_up</span>
</pre></div>
<p>Create instance of joint names and abbreviations for joystick values, button up and button down. The <code>joint_names()</code> method returns a list of joints associated with the limb. The <code>stick_value()</code> method returns the dead-banded, scaled and offset value of the axis. The abbreviations for all these functions are created to be used within the bindings dictionary below.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">102 </span>    <span class="k">def</span> <span class="nf">print_help</span><span class="p">(</span><span class="n">bindings_list</span><span class="p">):</span>
<span class="lineno">103 </span>        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl-C to quit.&quot;</span><span class="p">)</span>
<span class="lineno">104 </span>        <span class="k">for</span> <span class="n">bindings</span> <span class="ow">in</span> <span class="n">bindings_list</span><span class="p">:</span>
<span class="lineno">105 </span>            <span class="k">for</span> <span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">_cmd</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">bindings</span><span class="p">:</span>
<span class="lineno">106 </span>                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
<span class="lineno">107 </span>                    <span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span><span class="p">()</span>
<span class="lineno">108 </span>                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">doc</span><span class="p">))</span>
</pre></div>
<p>The information about the joystick buttons and the corresponding joints are displayed. This information is available in <code>bindings_list</code> as below. The <code>doc</code> refers to the last element of the tuple and it is checked if it is a callable function. So, if there is a lambda function that evaluates and returns a string, then that function is called. Finally, the results are displayed.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">110 </span>    <span class="n">bindings_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno">111 </span>    <span class="n">bindings</span> <span class="o">=</span> <span class="p">[</span>
<span class="lineno">112 </span>        <span class="p">((</span><span class="n">jlo</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;leftStickHorz&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">113 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Increase &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<span class="lineno">114 </span>        <span class="p">((</span><span class="n">jhi</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;leftStickHorz&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">115 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Decrease &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<span class="lineno">116 </span>        <span class="p">((</span><span class="n">jlo</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;leftStickVert&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">117 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Increase &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="lineno">118 </span>        <span class="p">((</span><span class="n">jhi</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;leftStickVert&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">119 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Decrease &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<span class="lineno">120 </span>        <span class="p">((</span><span class="n">jlo</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rightStickHorz&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">121 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Increase &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<span class="lineno">122 </span>        <span class="p">((</span><span class="n">jhi</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rightStickHorz&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">123 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Decrease &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<span class="lineno">124 </span>        <span class="p">((</span><span class="n">jlo</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rightStickVert&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">125 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Increase &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
<span class="lineno">126 </span>        <span class="p">((</span><span class="n">jhi</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rightStickVert&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_j</span><span class="p">,</span> <span class="p">[</span><span class="n">limb_cmd</span><span class="p">,</span> <span class="n">limb</span><span class="p">,</span> <span class="n">joints</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]),</span>
<span class="lineno">127 </span>            <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Decrease &quot;</span> <span class="o">+</span> <span class="n">joints</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
<span class="lineno">128 </span>        <span class="p">((</span><span class="n">bdn</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;leftBumper&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">rotate</span><span class="p">,</span> <span class="p">[</span><span class="n">joints</span><span class="p">]),</span> <span class="n">side</span> <span class="o">+</span> <span class="s2">&quot;: cycle joint&quot;</span><span class="p">),</span>
<span class="lineno">129 </span>        <span class="p">((</span><span class="n">bdn</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;function1&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">print_help</span><span class="p">,</span> <span class="p">[</span><span class="n">bindings_list</span><span class="p">]),</span> <span class="s2">&quot;help&quot;</span><span class="p">),</span>
<span class="lineno">130 </span>        <span class="p">((</span><span class="n">bdn</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;function2&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">print_help</span><span class="p">,</span> <span class="p">[</span><span class="n">bindings_list</span><span class="p">]),</span> <span class="s2">&quot;help&quot;</span><span class="p">),</span>
<span class="lineno">131 </span>        <span class="p">]</span>
<span class="lineno">132 </span>    <span class="k">if</span> <span class="n">gripper</span><span class="p">:</span>
<span class="lineno">133 </span>        <span class="n">bindings</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
<span class="lineno">134 </span>            <span class="p">((</span><span class="n">bdn</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rightTrigger&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_g</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span> <span class="n">gripper</span><span class="p">),</span> <span class="n">side</span> <span class="o">+</span> <span class="s2">&quot; gripper close&quot;</span><span class="p">),</span>
<span class="lineno">135 </span>            <span class="p">((</span><span class="n">bup</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;rightTrigger&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_g</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span> <span class="n">gripper</span><span class="p">),</span> <span class="n">side</span> <span class="o">+</span> <span class="s2">&quot; gripper open&quot;</span><span class="p">),</span>
<span class="lineno">136 </span>            <span class="p">((</span><span class="n">bdn</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;btnLeft&#39;</span><span class="p">]),</span> <span class="p">(</span><span class="n">set_g</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;calibrate&#39;</span><span class="p">],</span> <span class="n">gripper</span><span class="p">),</span> <span class="s2">&quot;right calibrate&quot;</span><span class="p">)</span>
<span class="lineno">137 </span>            <span class="p">])</span>
<span class="lineno">138 </span>    <span class="n">bindings_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bindings</span><span class="p">)</span>
</pre></div>
<p>The first element of every tuple refers to the command that has to be executed. As indicated above <code>set_j, bdn, bup, jhi</code> and <code>jlo</code> refers to the function and their acronyms. The second tuple has a list that holds the list of arguments to be passed along with that function. The last element holds a string or a function that evaluates and forms a string to detail the joint under consideration.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">140 </span>    <span class="n">rate</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Rate</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="lineno">141 </span>    <span class="n">print_help</span><span class="p">(</span><span class="n">bindings_list</span><span class="p">)</span>
<span class="lineno">142 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Press Ctrl-C to stop. &quot;</span><span class="p">)</span>
<span class="lineno">143 </span>    <span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">():</span>
<span class="lineno">144 </span>        <span class="k">for</span> <span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">bindings</span><span class="p">:</span>
<span class="lineno">145 </span>            <span class="k">if</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="lineno">146 </span>                <span class="n">cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="o">*</span><span class="n">cmd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="lineno">147 </span>                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
<span class="lineno">148 </span>                    <span class="k">print</span><span class="p">(</span><span class="n">doc</span><span class="p">())</span>
<span class="lineno">149 </span>                <span class="k">else</span><span class="p">:</span>
<span class="lineno">150 </span>                    <span class="k">print</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="lineno">151 </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">limb_cmd</span><span class="p">):</span>
<span class="lineno">152 </span>            <span class="n">limb</span><span class="o">.</span><span class="n">set_joint_positions</span><span class="p">(</span><span class="n">limb_cmd</span><span class="p">)</span>
<span class="lineno">153 </span>            <span class="n">limb_cmd</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="lineno">154 </span>        <span class="n">rate</span><span class="o">.</span><span class="n">sleep</span><span class="p">()</span>
<span class="lineno">155 </span>    <span class="k">return</span> <span class="bp">False</span>
</pre></div>
<p>The test tuple holds the function that needs to be called for a particular value to be tested. For instance, the first tuple holds the abbreviation bdn and the parameter rightTrigger that is passed along. This test function checks whether the joystick's button_down is pressed. If this is true then the cmd, that refers to the second tuple (gripper.close,[]) is parsed as above. For the first binding, the expression cmd[0](*cmd[1]) returns the function call gripper.close([]). The next line checks if the last tuple is a function (lambda) or not (string). Since the joints being controlled are updated dynamically, the lambda function is used to retrieve the current joints rj[0] and rj[1].
The dictionaries limb_cmd hold the joint commands for the limb. These dictionaries get populated when the set_j method is called by the previous section of code.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">158 </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="lineno">159 </span>    <span class="sd">&quot;&quot;&quot;SDK Joint Position Example: Joystick Control</span>
<span class="lineno">160 </span><span class="sd">    Use a game controller to control the angular joint positions</span>
<span class="lineno">161 </span><span class="sd">    of Sawyer&#39;s arms.</span>
<span class="lineno">162 </span><span class="sd">    Attach a game controller to your dev machine and run this</span>
<span class="lineno">163 </span><span class="sd">    example along with the ROS joy_node to control the position</span>
<span class="lineno">164 </span><span class="sd">    of each joint in Sawyer&#39;s arm using the joystick. Be sure to</span>
<span class="lineno">165 </span><span class="sd">    provide your *joystick* type to setup appropriate key mappings.</span>
<span class="lineno">166 </span><span class="sd">    Each stick axis maps to a joint angle; which joints are currently</span>
<span class="lineno">167 </span><span class="sd">    controlled can be incremented by using the mapped increment buttons.</span>
<span class="lineno">168 </span><span class="sd">    Ex:</span>
<span class="lineno">169 </span><span class="sd">      (x,y -&gt; e0,e1) &gt;&gt;increment&gt;&gt; (x,y -&gt; e1,e2)</span>
<span class="lineno">170 </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="lineno">171 </span>    <span class="n">epilog</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="lineno">172 </span><span class="s2">See help inside the example with the &quot;Start&quot; button for controller</span>
<span class="lineno">173 </span><span class="s2">key bindings.</span>
<span class="lineno">174 </span><span class="s2">    &quot;&quot;&quot;</span>
<span class="lineno">175 </span>    <span class="n">rp</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">RobotParams</span><span class="p">()</span>
<span class="lineno">176 </span>    <span class="n">valid_limbs</span> <span class="o">=</span> <span class="n">rp</span><span class="o">.</span><span class="n">get_limb_names</span><span class="p">()</span>
<span class="lineno">177 </span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_limbs</span><span class="p">:</span>
<span class="lineno">178 </span>        <span class="n">rp</span><span class="o">.</span><span class="n">log_message</span><span class="p">((</span><span class="s2">&quot;Cannot detect any limb parameters on this robot. &quot;</span>
<span class="lineno">179 </span>                        <span class="s2">&quot;Exiting.&quot;</span><span class="p">),</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">)</span>
<span class="lineno">180 </span>        <span class="k">return</span>
<span class="lineno">181 </span>    <span class="n">arg_fmt</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">RawDescriptionHelpFormatter</span>
<span class="lineno">182 </span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">formatter_class</span><span class="o">=</span><span class="n">arg_fmt</span><span class="p">,</span>
<span class="lineno">183 </span>                                     <span class="n">description</span><span class="o">=</span><span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span>
<span class="lineno">184 </span>                                     <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">)</span>
<span class="lineno">185 </span>    <span class="n">required</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="s1">&#39;required arguments&#39;</span><span class="p">)</span>
<span class="lineno">186 </span>    <span class="n">required</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="lineno">187 </span>        <span class="s1">&#39;-j&#39;</span><span class="p">,</span> <span class="s1">&#39;--joystick&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="lineno">188 </span>        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;xbox&#39;</span><span class="p">,</span> <span class="s1">&#39;logitech&#39;</span><span class="p">,</span> <span class="s1">&#39;ps3&#39;</span><span class="p">],</span>
<span class="lineno">189 </span>        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specify the type of joystick to use&#39;</span>
<span class="lineno">190 </span>    <span class="p">)</span>
<span class="lineno">191 </span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="lineno">192 </span>        <span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;--limb&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;limb&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">valid_limbs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="lineno">193 </span>        <span class="n">choices</span><span class="o">=</span><span class="n">valid_limbs</span><span class="p">,</span>
<span class="lineno">194 </span>        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Limb on which to run the joint position joystick example&quot;</span>
<span class="lineno">195 </span>    <span class="p">)</span>
<span class="lineno">196 </span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">rospy</span><span class="o">.</span><span class="n">myargv</span><span class="p">()[</span><span class="mi">1</span><span class="p">:])</span>
<span class="lineno">197 </span>
<span class="lineno">198 </span>    <span class="n">joystick</span> <span class="o">=</span> <span class="bp">None</span>
<span class="lineno">199 </span>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">joystick</span> <span class="o">==</span> <span class="s1">&#39;xbox&#39;</span><span class="p">:</span>
<span class="lineno">200 </span>        <span class="n">joystick</span> <span class="o">=</span> <span class="n">intera_external_devices</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">XboxController</span><span class="p">()</span>
<span class="lineno">201 </span>    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">joystick</span> <span class="o">==</span> <span class="s1">&#39;logitech&#39;</span><span class="p">:</span>
<span class="lineno">202 </span>        <span class="n">joystick</span> <span class="o">=</span> <span class="n">intera_external_devices</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">LogitechController</span><span class="p">()</span>
<span class="lineno">203 </span>    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">joystick</span> <span class="o">==</span> <span class="s1">&#39;ps3&#39;</span><span class="p">:</span>
<span class="lineno">204 </span>        <span class="n">joystick</span> <span class="o">=</span> <span class="n">intera_external_devices</span><span class="o">.</span><span class="n">joystick</span><span class="o">.</span><span class="n">PS3Controller</span><span class="p">()</span>
<span class="lineno">205 </span>    <span class="k">else</span><span class="p">:</span>
<span class="lineno">206 </span>        <span class="n">parser</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Unsupported joystick type &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">joystick</span><span class="p">))</span>
<span class="lineno">207 </span>
<span class="lineno">208 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Initializing node... &quot;</span><span class="p">)</span>
<span class="lineno">209 </span>    <span class="n">rospy</span><span class="o">.</span><span class="n">init_node</span><span class="p">(</span><span class="s2">&quot;sdk_joint_position_joystick&quot;</span><span class="p">)</span>
<span class="lineno">210 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Getting robot state... &quot;</span><span class="p">)</span>
<span class="lineno">211 </span>    <span class="n">rs</span> <span class="o">=</span> <span class="n">intera_interface</span><span class="o">.</span><span class="n">RobotEnable</span><span class="p">(</span><span class="n">CHECK_VERSION</span><span class="p">)</span>
<span class="lineno">212 </span>    <span class="n">init_state</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">state</span><span class="p">()</span><span class="o">.</span><span class="n">enabled</span>
</pre></div>
<p>The type of joystick input is captured as entered by the user and an instance of the corresponding interface is created.
The node is initialized and the robot is enabled.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="lineno">217 </span>    <span class="k">def</span> <span class="nf">clean_shutdown</span><span class="p">():</span>
<span class="lineno">218 </span>        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exiting example.&quot;</span><span class="p">)</span>
<span class="lineno">219 </span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">init_state</span><span class="p">:</span>
<span class="lineno">220 </span>            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Disabling robot...&quot;</span><span class="p">)</span>
<span class="lineno">221 </span>            <span class="n">rs</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="lineno">222 </span>    <span class="n">rospy</span><span class="o">.</span><span class="n">on_shutdown</span><span class="p">(</span><span class="n">clean_shutdown</span><span class="p">)</span>
<span class="lineno">223 </span>
<span class="lineno">224 </span>    <span class="n">rospy</span><span class="o">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s2">&quot;Enabling robot...&quot;</span><span class="p">)</span>
<span class="lineno">225 </span>    <span class="n">rs</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="lineno">226 </span>
<span class="lineno">227 </span>    <span class="n">map_joystick</span><span class="p">(</span><span class="n">joystick</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">limb</span><span class="p">)</span>
<span class="lineno">228 </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
<span class="lineno">229 </span>
<span class="lineno">230 </span>
<span class="lineno">231 </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="lineno">232 </span>    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>The <code>map_joystick()</code> method performs the mapping and execution of the commands as explained above.
</p>
</div>

<!-- 
NewPP limit report
Cached time: 20191018041852
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.162 seconds
Real time usage: 7.326 seconds
Preprocessor visited node count: 221/1000000
Preprocessor generated node count: 640/1000000
Post‐expand include size: 37/2097152 bytes
Template argument size: 1/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 71002/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.487      1 Template:TOClimit
100.00%    0.487      1 -total
-->
</div>
<!-- Saved in parser cache with key interasdk:pcache:idhash:57-0!canonical and timestamp 20191018041845 and revision id 1165
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;oldid=1165">http://sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&amp;oldid=1165</a>"</div>

            <div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>            <!-- end content -->

                        <div class="visualClear"></div>
        </div><!--/#bodyContent-->
    </div> <!-- /mainContent -->
</div><!--/.bg-wrapper
<!-- end fragment mainContent --></div><!-- /mBody --><div class="visualClear"></div><!-- start fragment footer -->        <div id="footer" role="contentinfo">
                <div id="f-poweredbyico">
                            <a href="http://www.mediawiki.org/"><img src="http://sdk.rethinkrobotics.com/intera/a/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/intera/a/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /intera/a/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>                    </div>
            <ul id="f-list">
                            <li id="copywrite_notice">&copy; 2019 Rethink Robotics. All rights reserved.</li>
                            <li id="special_pages"><a href="http://sdk.rethinkrobotics.com/intera/⧼specialPagePage⧽" title="⧼specialPagePage⧽">Special page</a></li>
                            <li id="privacy"><a href="http://sdk.rethinkrobotics.com/intera/Intera_SDK:Privacy_policy" title="Intera SDK:Privacy policy">Privacy policy</a></li>
                            <li id="about"><a href="http://sdk.rethinkrobotics.com/intera/Intera_SDK:About" title="Intera SDK:About">About Intera SDK</a></li>
                            <li id="disclaimer"><a href="http://sdk.rethinkrobotics.com/intera/Intera_SDK:General_disclaimer" title="Intera SDK:General disclaimer">Disclaimers</a></li>
                    </ul><!--/#f-list-->
    </div><!-- end fragment footer --></div><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.162","walltime":"7.326","ppvisitednodes":{"value":221,"limit":1000000},"ppgeneratednodes":{"value":640,"limit":1000000},"postexpandincludesize":{"value":37,"limit":2097152},"templateargumentsize":{"value":1,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":71002,"limit":5000000},"timingprofile":["100.00%    0.487      1 Template:TOClimit","100.00%    0.487      1 -total"]},"cachereport":{"timestamp":"20191018041852","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":43});});</script></body>
<!-- Mirrored from sdk.rethinkrobotics.com/intera/a/index.php?title=Joint_Position_Example&oldid=1165 by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Oct 2019 05:22:45 GMT -->
</html>